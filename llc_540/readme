#Build executable for llc540 with latest MITgcm code on pleiades
 cvs co MITgcm_contrib/llc_hires/llc_540
 git clone https://github.com/MITgcm/MITgcm.git
 cd MITgcm
 mkdir build run
 cd build
 module purge
 module load comp-intel/2016.2.181 mpi-sgi/mpt.2.14r19 hdf4/4.2.12 hdf5/1.8.18_mpt netcdf/4.4.1.1_mpt
 ../tools/genmake2 -of ../tools/build_options/linux_amd64_ifort+mpi_ice_nas \
    -mo ../../MITgcm_contrib/llc_hires/llc_540/code
 make depend
 make -j 16

# integrate 1992-2019 model on pleiades
# jra55 forcing
 cd ../run
 cp ../../MITgcm_contrib/llc_hires/llc_540/input/* .
 ln -sf /nobackup/hzhang1/llc_540/run_template/pickup*432.*ta .
 ln -sf /nobackup/hzhang1/llc_540/run_template/tile* .
 ln -sf /nobackup/hzhang1/llc_540/run_template/Bathy_*_v2.bin .
 ln -sf /nobackup/hzhang1/llc_540/run_template/DIFFKR* .
 ln -sf /nobackup/hzhang1/forcing/jra55 .
 ln -sf /nobackup/dcarrol2/LOAC/write_bin/jra55_do/v1.4.0/LLC_540/jra55* .
 ln -sf ../build/mitgcmuv .
 qsub job_ivy_llc540

# jra55do forcing
 cd ../run
 cp ../../MITgcm_contrib/llc_hires/llc_540/input/* .
 ln -sf /nobackup/hzhang1/llc_540/run_template/pickup*432.*ta .
 ln -sf /nobackup/hzhang1/llc_540/run_template/tile* .
 ln -sf /nobackup/hzhang1/llc_540/run_template/Bathy_*_v2.bin .
 ln -sf /nobackup/hzhang1/llc_540/run_template/DIFFKR* .
 ln -sf /nobackup/hzhang1/forcing/jra55_do .
 ln -sf data.exf_jra55do data.exf
 ln -sf /nobackup/dcarrol2/LOAC/write_bin/jra55_do/v1.4.0/LLC_540/jra55* .
 ln -sf ../build/mitgcmuv .
 qsub job_ivy_llc540

# eraxx forcing
 cd ../run
 cp ../../MITgcm_contrib/llc_hires/llc_540/input/* .
 ln -sf /nobackup/hzhang1/llc_540/run_template/pickup*432.*ta .
 ln -sf /nobackup/hzhang1/llc_540/run_template/tile* .
 ln -sf /nobackup/hzhang1/llc_540/run_template/Bathy_*_v2.bin .
 ln -sf /nobackup/hzhang1/llc_540/run_template/DIFFKR* .
 ln -sf /nobackup/hzhang1/forcing/era_xx_it50 .
 ln -sf data.exf_eraxx data.exf
 ln -sf /nobackup/dcarrol2/LOAC/write_bin/jra55_do/v1.4.0/LLC_540/jra55* .
 ln -sf ../build/mitgcmuv .
 qsub job_ivy_llc540

##################
#to run on small number of cpus
#build:  ln -sf SIZE.h_60 SIZE.h
#run:    ln -sf data.exch2_60 data.exch2 
#        qsub job_ivy_llc540_60

##################
Rain correction factors
Aiming for 1.5 +/1 1 mm/year barystatic sea level increase

jra55
unadjusted sea level increase: 322.5 mm/yr
correction needed: -321 mm/yr
mean precip over ocean: 4.267e-8 m/s =  1346.6 mm/yr
correction factor: (1346.6-321)/1346.6 = 0.7616

jra55do
unadjusted sea level increase: 29.6 mm/yr
correction needed: -28.1 mm/yr
mean precip over ocean: 3.4788e-8 m/s =  1097.83 mm/yr
correction factor: (1097.83-28.1)/1097.83 = 0.9744

eraxx
unadjusted sea level increase: 13.1 mm/yr
correction needed: -11.6 mm/yr
mean precip over ocean: 3.8299e-8 m/s =  1208.62 mm/yr
correction factor: (1208.62-11.6)/1208.62 = 0.9904
#run: ln -sf data.exf_eraxx_scal_precip data.exf
